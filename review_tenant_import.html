<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tenant Import Review - Sanctuary Office Park</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2rem;
            margin-bottom: 10px;
        }

        .header .meta {
            opacity: 0.9;
            font-size: 0.9rem;
        }

        .controls {
            padding: 20px 30px;
            background: #f8f9fa;
            border-bottom: 2px solid #e0e0e0;
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            align-items: center;
        }

        .search-box {
            flex: 1;
            min-width: 200px;
        }

        .search-box input {
            width: 100%;
            padding: 10px 15px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 1rem;
        }

        .search-box input:focus {
            outline: none;
            border-color: #667eea;
        }

        .filter-group {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .filter-group select {
            padding: 10px 15px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 0.9rem;
            background: white;
            cursor: pointer;
        }

        .stats {
            display: flex;
            gap: 20px;
            padding: 20px 30px;
            background: #f8f9fa;
            border-bottom: 2px solid #e0e0e0;
        }

        .stat-card {
            flex: 1;
            background: white;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .stat-card .label {
            font-size: 0.85rem;
            color: #666;
            margin-bottom: 5px;
        }

        .stat-card .value {
            font-size: 1.5rem;
            font-weight: 600;
            color: #667eea;
        }

        .tenants-list {
            padding: 30px;
        }

        .tenant-card {
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 20px;
            transition: all 0.3s;
        }

        .tenant-card:hover {
            border-color: #667eea;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.2);
            transform: translateY(-2px);
        }

        .tenant-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #f0f0f0;
        }

        .tenant-name {
            font-size: 1.4rem;
            font-weight: 600;
            color: #333;
            margin-bottom: 5px;
        }

        .tenant-type {
            display: inline-block;
            padding: 4px 12px;
            background: #3498db;
            color: white;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            margin-right: 8px;
        }

        .tenant-status {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
        }

        .status-active {
            background: #2ecc71;
            color: white;
        }

        .status-past {
            background: #95a5a6;
            color: white;
        }

        .tenant-body {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 20px;
        }

        @media (max-width: 768px) {
            .tenant-body {
                grid-template-columns: 1fr;
            }
        }

        .section {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
        }

        .section-title {
            font-size: 1rem;
            font-weight: 600;
            color: #667eea;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .section-title::before {
            content: '';
            width: 4px;
            height: 20px;
            background: #667eea;
            border-radius: 2px;
        }

        .notes {
            white-space: pre-wrap;
            color: #666;
            font-size: 0.9rem;
            line-height: 1.6;
        }

        .contacts-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .contact-item {
            background: white;
            padding: 12px;
            border-radius: 8px;
            border-left: 3px solid #667eea;
        }

        .contact-name {
            font-weight: 600;
            color: #333;
            margin-bottom: 5px;
        }

        .contact-info {
            font-size: 0.85rem;
            color: #666;
            margin: 3px 0;
        }

        .contact-info a {
            color: #667eea;
            text-decoration: none;
        }

        .contact-info a:hover {
            text-decoration: underline;
        }

        .contact-classifications {
            display: flex;
            gap: 6px;
            flex-wrap: wrap;
            margin-top: 8px;
        }

        .classification-badge {
            padding: 3px 8px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 10px;
            font-size: 0.7rem;
            font-weight: 600;
        }

        .occupancies-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .occupancy-item {
            background: white;
            padding: 12px;
            border-radius: 8px;
            border-left: 3px solid #2ecc71;
        }

        .occupancy-header {
            font-weight: 600;
            color: #333;
            margin-bottom: 8px;
        }

        .occupancy-details {
            font-size: 0.85rem;
            color: #666;
            margin: 3px 0;
        }

        .occupancy-notes {
            margin-top: 8px;
            padding-top: 8px;
            border-top: 1px solid #e0e0e0;
            font-size: 0.85rem;
            color: #666;
        }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #999;
        }

        .empty-state h2 {
            font-size: 1.5rem;
            margin-bottom: 10px;
        }

        .loading {
            text-align: center;
            padding: 60px 20px;
            color: #667eea;
            font-size: 1.2rem;
        }

        .file-input-wrapper {
            position: relative;
            display: inline-block;
        }

        .file-input-wrapper input[type="file"] {
            position: absolute;
            opacity: 0;
            width: 100%;
            height: 100%;
            cursor: pointer;
        }

        .file-input-button {
            padding: 10px 20px;
            background: #667eea;
            color: white;
            border-radius: 8px;
            cursor: pointer;
            display: inline-block;
            font-weight: 600;
        }

        .file-input-button:hover {
            background: #764ba2;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Tenant Import Review</h1>
            <div class="meta">Sanctuary Office Park - Review JSON Data Before Import</div>
        </div>

        <div class="controls">
            <div class="file-input-wrapper">
                <input type="file" id="jsonFileInput" accept=".json">
                <div class="file-input-button">üìÅ Load JSON File</div>
            </div>
            <div class="search-box">
                <input type="text" id="searchInput" placeholder="Search tenants, contacts, units...">
            </div>
            <div class="filter-group">
                <select id="statusFilter">
                    <option value="">All Statuses</option>
                    <option value="Active">Active</option>
                    <option value="Past">Past</option>
                </select>
                <select id="buildingFilter">
                    <option value="">All Buildings</option>
                    <option value="1">Building 1</option>
                    <option value="2">Building 2</option>
                    <option value="3">Building 3</option>
                    <option value="4">Building 4</option>
                    <option value="5">Building 5</option>
                </select>
            </div>
        </div>

        <div class="stats" id="statsContainer" style="display: none;">
            <div class="stat-card">
                <div class="label">Total Tenants</div>
                <div class="value" id="totalTenants">0</div>
            </div>
            <div class="stat-card">
                <div class="label">Total Contacts</div>
                <div class="value" id="totalContacts">0</div>
            </div>
            <div class="stat-card">
                <div class="label">Total Occupancies</div>
                <div class="value" id="totalOccupancies">0</div>
            </div>
            <div class="stat-card">
                <div class="label">Filtered Results</div>
                <div class="value" id="filteredCount">0</div>
            </div>
        </div>

        <div class="tenants-list" id="tenantsContainer">
            <div class="loading">Please load a JSON file to begin review</div>
        </div>
    </div>

    <script>
        let allTenants = [];
        let filteredTenants = [];

        // Load JSON file
        document.getElementById('jsonFileInput').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const data = JSON.parse(e.target.result);
                    allTenants = data.tenants || [];
                    filteredTenants = [...allTenants];
                    updateStats();
                    renderTenants();
                } catch (error) {
                    alert('Error parsing JSON file: ' + error.message);
                }
            };
            reader.readAsText(file);
        });

        // Auto-load removed - manual file selection only

        // Search functionality
        document.getElementById('searchInput').addEventListener('input', function(e) {
            filterTenants();
        });

        // Filter functionality
        document.getElementById('statusFilter').addEventListener('change', function() {
            filterTenants();
        });

        document.getElementById('buildingFilter').addEventListener('change', function() {
            filterTenants();
        });

        function filterTenants() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const statusFilter = document.getElementById('statusFilter').value;
            const buildingFilter = document.getElementById('buildingFilter').value;

            filteredTenants = allTenants.filter(tenant => {
                // Search filter
                if (searchTerm) {
                    const searchableText = [
                        tenant.tenantName,
                        tenant.notes || '',
                        ...(tenant.contacts || []).map(c => c.contactName + ' ' + (c.contactEmail || '') + ' ' + (c.contactPhone || '')),
                        ...(tenant.occupancies || []).map(o => o.unitNumber || '' + ' ' + (o.buildingNumber || ''))
                    ].join(' ').toLowerCase();

                    if (!searchableText.includes(searchTerm)) {
                        return false;
                    }
                }

                // Status filter
                if (statusFilter && tenant.status !== statusFilter) {
                    return false;
                }

                // Building filter
                if (buildingFilter) {
                    const hasBuilding = (tenant.occupancies || []).some(o => 
                        o.buildingNumber === buildingFilter
                    );
                    if (!hasBuilding) {
                        return false;
                    }
                }

                return true;
            });

            updateStats();
            renderTenants();
        }

        function updateStats() {
            const totalContacts = allTenants.reduce((sum, t) => sum + (t.contacts?.length || 0), 0);
            const totalOccupancies = allTenants.reduce((sum, t) => sum + (t.occupancies?.length || 0), 0);

            document.getElementById('totalTenants').textContent = allTenants.length;
            document.getElementById('totalContacts').textContent = totalContacts;
            document.getElementById('totalOccupancies').textContent = totalOccupancies;
            document.getElementById('filteredCount').textContent = filteredTenants.length;
            document.getElementById('statsContainer').style.display = 'flex';
        }

        function renderTenants() {
            const container = document.getElementById('tenantsContainer');

            if (filteredTenants.length === 0) {
                container.innerHTML = '<div class="empty-state"><h2>No tenants found</h2><p>Try adjusting your search or filters</p></div>';
                return;
            }

            container.innerHTML = filteredTenants.map(tenant => {
                const contactsHtml = (tenant.contacts || []).map(contact => `
                    <div class="contact-item">
                        <div class="contact-name">${escapeHtml(contact.contactName)}</div>
                        ${contact.contactTitle ? `<div class="contact-info">üíº ${escapeHtml(contact.contactTitle)}</div>` : ''}
                        ${contact.contactEmail ? `<div class="contact-info">‚úâÔ∏è <a href="mailto:${escapeHtml(contact.contactEmail)}">${escapeHtml(contact.contactEmail)}</a></div>` : ''}
                        ${contact.contactPhone ? `<div class="contact-info">üìû <a href="tel:${escapeHtml(contact.contactPhone)}">${escapeHtml(contact.contactPhone)}</a></div>` : ''}
                        ${contact.classifications && contact.classifications.length > 0 ? `
                            <div class="contact-classifications">
                                ${contact.classifications.map(c => `<span class="classification-badge">${escapeHtml(c)}</span>`).join('')}
                            </div>
                        ` : ''}
                    </div>
                `).join('');

                const occupanciesHtml = (tenant.occupancies || []).map(occupancy => `
                    <div class="occupancy-item">
                        <div class="occupancy-header">
                            ${occupancy.buildingNumber ? `Building ${occupancy.buildingNumber}` : 'Property Level'}
                            ${occupancy.unitNumber ? ` - Unit ${escapeHtml(occupancy.unitNumber)}` : ''}
                            <span class="tenant-status status-${(occupancy.status || 'active').toLowerCase()}">${escapeHtml(occupancy.status || 'Active')}</span>
                        </div>
                        ${occupancy.moveInDate ? `<div class="occupancy-details">üìÖ Move-In: ${escapeHtml(occupancy.moveInDate)}</div>` : ''}
                        ${occupancy.moveOutDate ? `<div class="occupancy-details">üìÖ Move-Out: ${escapeHtml(occupancy.moveOutDate)}</div>` : ''}
                        ${occupancy.notes ? `<div class="occupancy-notes">${escapeHtml(occupancy.notes)}</div>` : ''}
                    </div>
                `).join('');

                return `
                    <div class="tenant-card">
                        <div class="tenant-header">
                            <div>
                                <div class="tenant-name">${escapeHtml(tenant.tenantName)}</div>
                                <div>
                                    <span class="tenant-type">${escapeHtml(tenant.tenantType)}</span>
                                    <span class="tenant-status status-${(tenant.status || 'active').toLowerCase()}">${escapeHtml(tenant.status || 'Active')}</span>
                                </div>
                            </div>
                        </div>
                        <div class="tenant-body">
                            <div class="section">
                                <div class="section-title">Contacts (${tenant.contacts?.length || 0})</div>
                                ${contactsHtml || '<div class="notes">No contacts</div>'}
                            </div>
                            <div class="section">
                                <div class="section-title">Occupancies (${tenant.occupancies?.length || 0})</div>
                                ${occupanciesHtml || '<div class="notes">No occupancies</div>'}
                            </div>
                        </div>
                        ${tenant.notes ? `
                            <div class="section" style="margin-top: 20px;">
                                <div class="section-title">Notes</div>
                                <div class="notes">${escapeHtml(tenant.notes)}</div>
                            </div>
                        ` : ''}
                    </div>
                `;
            }).join('');
        }

        function escapeHtml(text) {
            if (!text) return '';
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }
    </script>
</body>
</html>

